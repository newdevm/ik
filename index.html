<script type="text/javascript">
    var gk_isXlsx = false;
    var gk_xlsxFileLookup = {};
    var gk_fileData = {};
    function filledCell(cell) {
      return cell !== '' && cell != null;
    }
    function loadFileData(filename) {
    if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
        try {
            var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
            var firstSheetName = workbook.SheetNames[0];
            var worksheet = workbook.Sheets[firstSheetName];

            // Convert sheet to JSON to filter blank rows
            var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
            // Filter out blank rows (rows where all cells are empty, null, or undefined)
            var filteredData = jsonData.filter(row => row.some(filledCell));

            // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
            var headerRowIndex = filteredData.findIndex((row, index) =>
              row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
            );
            // Fallback
            if (headerRowIndex === -1 || headerRowIndex > 25) {
              headerRowIndex = 0;
            }

            // Convert filtered JSON back to CSV
            var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
            csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
            return csv;
        } catch (e) {
            console.error(e);
            return "";
        }
    }
    return gk_fileData[filename] || "";
    }
</script>
<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intia-Keskus - Matkoja Yli 40 Vuotta</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background-image: url('./img/background.gif');
            background-size: repeat;
            background-attachment: fixed;
            color: #333;
            line-height: 1.6;
        }

        .container {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .left-sidebar {
            width: 250px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            padding: 20px;
            position: sticky;
            top: 20px;
            height: fit-content;
            border-radius: 10px;
        }

        .left-sidebar ul {
            list-style: none;
        }

        .left-sidebar ul li {
            margin: 15px 0;
            position: relative;
        }

        .left-sidebar ul li a {
            text-decoration: none;
            color: #0066cc;
            font-weight: bold;
            transition: color 0.3s;
            display: block;
        }

        .left-sidebar ul li a:hover {
            color: #ff6200;
        }

        .left-sidebar ul ul {
            display: none;
            position: absolute;
            left: 100%;
            top: 0;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            min-width: 200px;
            z-index: 10;
        }

        .left-sidebar ul li:hover > ul {
            display: block;
        }

        .left-sidebar ul ul li {
            margin: 0;
            padding: 5px 10px;
        }

        .left-sidebar ul ul li a {
            font-weight: normal;
            padding: 5px;
        }

        .main-content {
            flex: 1;
            padding: 0 20px;
        }

        .main-content iframe {
            width: 100%;
            height: 600px; /* Adjustable height */
            border: none;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 10px;
        }

        .right-sidebar {
            width: 250px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
            padding: 20px;
            position: sticky;
            top: 20px;
            height: fit-content;
            border-radius: 10px;
            text-align: center;
        }

        .right-sidebar img {
            max-width: 100%;
            border-radius: 8px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 10px 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .logo img {
            max-width: 150px;
        }

        .hero {
            text-align: center;
            padding: 50px 20px;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 10px;
            margin: 20px 0;
        }

        .hero h1 {
            font-size: 2.5em;
            color: #0066cc;
            margin-bottom: 10px;
        }

        .carousel {
            overflow: hidden;
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 20px auto;
        }

        .carousel-track {
            display: flex;
            transition: transform 0.5s ease;
        }

        .carousel-item {
            min-width: 200px;
            margin: 10px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .carousel-item img {
            max-width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .carousel-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: #0066cc;
            color: white;
            border: none;
            padding: 10px;
            cursor: pointer;
            border-radius: 50%;
            font-size: 1.2em;
            z-index: 10;
        }

        .prev {
            left: 10px;
        }

        .next {
            right: 10px;
        }

        .content {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .content h2 {
            color: #0066cc;
            margin-bottom: 15px;
        }

        footer {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            text-align: center;
            border-radius: 10px;
        }

        footer p {
            margin: 5px 0;
        }

        footer a {
            color: #0066cc;
            text-decoration: none;
        }

        footer a:hover {
            color: #ff6200;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .left-sidebar, .right-sidebar {
                width: 100%;
                position: static;
                margin-bottom: 20px;
            }

            .main-content {
                padding: 0;
            }

            .hero h1 {
                font-size: 1.8em;
            }

            .carousel-item {
                min-width: 150px;
            }

            .left-sidebar ul ul {
                position: static;
                width: 100%;
                box-shadow: none;
            }

            .left-sidebar ul li:hover > ul {
                display: none;
            }

            .left-sidebar ul li.active > ul {
                display: block;
            }

            .main-content iframe {
                height: 400px; /* Adjusted for mobile */
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left-sidebar">
            <ul>
                <li><a href="#etusivu">Etusivu</a></li>
                <li><a href="#lentohinnat">Lentohinnat</a></li>
                <li><a href="#paketit">Lento ja hotellipaketti</a></li>
                <li><a href="#maailmanympari">Maailman ympäri</a></li>
                <li><a href="#thaimaa">Thaimaa</a></li>
                <li>
                    <a href="#intia">Intia</a>
                    <ul>
                        <li><a href="juhlamatka.html" target="contentFrame">Ryhmämatkat</a></li>
                        <li><a href="#erikois">Erikoismatka</a></li>
                        <li><a href="#unelma">Unelma matka</a></li>
                        <li><a href="#kultainen">Kultainen kolmio</a></li>
                        <li><a href="#klassinen">Klassinen Intia</a></li>
                        <li><a href="#loytore">Löytöretki</a></li>
                        <li><a href="#kerala">Kerala intromatka</a></li>
                        <li><a href="#palace">Palace On Wheels</a></li>
                        <li><a href="#royal">Royal Orient</a></li>
                        <li><a href="#ominpain">Intia ominpääin</a></li>
                        <li><a href="#nepal">Intia-Nepal</a></li>
                        <li><a href="#delhi">Delhi starttipaketti</a></li>
                        <li><a href="#mumbai">Mumbai</a></li>
                        <li><a href="#dharam">Dharamshala</a></li>
                        <li><a href="#darjeeling">Darjeeling, Sikkim</a></li>
                        <li><a href="#hemis">Hemis</a></li>
                        <li><a href="#jooga">Jooga</a></li>
                        <li><a href="#hotellit">Hotellit</a></li>
                        <li><a href="#junapassi">Junapassi</a></li>
                        <li><a href="#juna-aikataulut">Juna-aikataulut</a></li>
                        <li><a href="#osavaltiot">Osavaltiot</a></li>
                        <li><a href="#bollywood">Bollywood-tv</a></li>
                    </ul>
                </li>
                <li><a href="#ohjeita">Ohjeita Intiaan matkaaville</a></li>
                <li><a href="#nepal">Nepal</a></li>
                <li><a href="#srilanka">Sri Lanka</a></li>
                <li><a href="#indonesia">Indonesia</a></li>
                <li><a href="#malediivit">Malediivit</a></li>
                <li><a href="#afrikka">Afrikka</a></li>
                <li><a href="#junapassi">Japanin junapassi</a></li>
                <li><a href="#kysely">Kysely/tarjouslomake</a></li>
                <li><a href="#viisumit">Viisumikaavakkeet</a></li>
                <li><a href="#maksutavat">Maksutavat</a></li>
                <li><a href="#tilausehdot">Tilausehdot</a></li>
                <li><a href="#kartta">Intia-Keskus kartalla</a></li>
                <li><a href="#kirja">Tilaa Mahatma Gandhi -kirja</a></li>
            </ul>
        </div>
        <div class="main-content">
            <header>
                <div class="">
                    <img src="./img/otsikko_keski.gif" alt="Intia-Keskus Logo">
                    <button id="langToggle" style="margin-left: 20px; padding: 5px 10px; cursor: pointer;">Switch to English</button>
                </div>
            </header>
            <iframe name="contentFrame" src="about:blank"></iframe>
            <footer>
                <p>Matkojen varaukset puhelimitse: <strong>09-680 3180</strong></p>
                <p>Sähköposti: <a href="mailto:sales@intiakeskus.fi">sales@intiakeskus.fi</a></p>
                <p>Tarkistakaa sähköpostit myös roskapostikansiosta.</p>
                <p><a href="https://facebook.com">Facebook</a></p>
            </footer>
        </div>
        <div class="right-sidebar">
            <img src="./img/patsas.jpg" alt="Krishna">
            <p>Krishna</p>
        </div>
    </div>
    <script>
        const track = document.querySelector('.carousel-track');
        const items = document.querySelectorAll('.carousel-item');
        const prevButton = document.querySelector('.prev');
        const nextButton = document.querySelector('.next');
        let currentIndex = 0;
        const itemWidth = items[0].getBoundingClientRect().width + 20;

        function updateCarousel() {
            track.style.transform = `translateX(-${currentIndex * itemWidth}px)`;
        }

        nextButton.addEventListener('click', () => {
            if (currentIndex < items.length - 3) {
                currentIndex++;
                updateCarousel();
            }
        });

        prevButton.addEventListener('click', () => {
            if (currentIndex > 0) {
                currentIndex--;
                updateCarousel();
            }
        });

        // Smooth scrolling for nav links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', (e) => {
                e.preventDefault();
                const target = document.querySelector(anchor.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // Language switcher
        document.getElementById('langToggle').addEventListener('click', () => {
            window.location.href = 'en/index_en.html';
        });

        // Optional: Toggle submenu on mobile
        const intiaLink = document.querySelector('a[href="#intia"]');
        const submenu = intiaLink.nextElementSibling;
        if (submenu && window.innerWidth <= 768) {
            intiaLink.addEventListener('click', (e) => {
                e.preventDefault();
                submenu.style.display = submenu.style.display === 'block' ? 'none' : 'block';
                intiaLink.parentElement.classList.toggle('active');
            });
        }
    </script>
